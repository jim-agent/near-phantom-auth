{"version":3,"sources":["../../src/client/api.ts","../../src/client/passkey.ts","../../src/client/hooks/useAnonAuth.tsx"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["/**\n * API Client for near-anon-auth server\n */\n\nimport type {\n  RegistrationStartResponse,\n  RegistrationFinishResponse,\n  AuthenticationStartResponse,\n  AuthenticationFinishResponse,\n  RegistrationResponseJSON,\n  AuthenticationResponseJSON,\n} from '../types/index.js';\n\nexport interface ApiClientConfig {\n  /** Base URL for auth API (e.g., '/auth' or 'https://api.example.com/auth') */\n  baseUrl: string;\n  /** Custom fetch function (optional) */\n  fetch?: typeof fetch;\n}\n\nexport interface SessionInfo {\n  authenticated: boolean;\n  codename?: string;\n  nearAccountId?: string;\n  expiresAt?: string;\n}\n\nexport interface ApiClient {\n  // Registration\n  startRegistration(): Promise<RegistrationStartResponse & { codename: string; tempUserId: string }>;\n  finishRegistration(\n    challengeId: string,\n    response: RegistrationResponseJSON,\n    tempUserId: string,\n    codename: string\n  ): Promise<RegistrationFinishResponse>;\n  \n  // Authentication\n  startAuthentication(codename?: string): Promise<AuthenticationStartResponse>;\n  finishAuthentication(\n    challengeId: string,\n    response: AuthenticationResponseJSON\n  ): Promise<AuthenticationFinishResponse>;\n  \n  // Session\n  getSession(): Promise<SessionInfo>;\n  logout(): Promise<void>;\n  \n  // Wallet Recovery\n  startWalletLink(): Promise<{ challenge: string; expiresAt: string }>;\n  finishWalletLink(\n    signature: unknown,\n    challenge: string,\n    walletAccountId: string\n  ): Promise<{ success: boolean; message: string }>;\n  startWalletRecovery(): Promise<{ challenge: string; expiresAt: string }>;\n  finishWalletRecovery(\n    signature: unknown,\n    challenge: string,\n    nearAccountId: string\n  ): Promise<{ success: boolean; codename: string; message: string }>;\n  \n  // IPFS Recovery\n  setupIPFSRecovery(password: string): Promise<{ success: boolean; cid: string; message: string }>;\n  recoverFromIPFS(cid: string, password: string): Promise<{ success: boolean; codename: string; message: string }>;\n}\n\n/**\n * Create API client\n */\nexport function createApiClient(config: ApiClientConfig): ApiClient {\n  const fetchFn = config.fetch || fetch;\n  const baseUrl = config.baseUrl.replace(/\\/$/, ''); // Remove trailing slash\n\n  async function request<T>(\n    method: string,\n    path: string,\n    body?: unknown\n  ): Promise<T> {\n    const response = await fetchFn(`${baseUrl}${path}`, {\n      method,\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      credentials: 'include', // Include cookies\n      body: body ? JSON.stringify(body) : undefined,\n    });\n\n    if (!response.ok) {\n      const error = await response.json().catch(() => ({ error: 'Request failed' }));\n      throw new Error(error.error || `Request failed: ${response.status}`);\n    }\n\n    return response.json();\n  }\n\n  return {\n    // Registration\n    async startRegistration() {\n      return request('POST', '/register/start');\n    },\n\n    async finishRegistration(challengeId, response, tempUserId, codename) {\n      return request('POST', '/register/finish', {\n        challengeId,\n        response,\n        tempUserId,\n        codename,\n      });\n    },\n\n    // Authentication\n    async startAuthentication(codename) {\n      return request('POST', '/login/start', { codename });\n    },\n\n    async finishAuthentication(challengeId, response) {\n      return request('POST', '/login/finish', {\n        challengeId,\n        response,\n      });\n    },\n\n    // Session\n    async getSession() {\n      try {\n        return await request('GET', '/session');\n      } catch {\n        return { authenticated: false };\n      }\n    },\n\n    async logout() {\n      await request('POST', '/logout');\n    },\n\n    // Wallet Recovery\n    async startWalletLink() {\n      return request('POST', '/recovery/wallet/link');\n    },\n\n    async finishWalletLink(signature, challenge, walletAccountId) {\n      return request('POST', '/recovery/wallet/verify', {\n        signature,\n        challenge,\n        walletAccountId,\n      });\n    },\n\n    async startWalletRecovery() {\n      return request('POST', '/recovery/wallet/start');\n    },\n\n    async finishWalletRecovery(signature, challenge, nearAccountId) {\n      return request('POST', '/recovery/wallet/finish', {\n        signature,\n        challenge,\n        nearAccountId,\n      });\n    },\n\n    // IPFS Recovery\n    async setupIPFSRecovery(password) {\n      return request('POST', '/recovery/ipfs/setup', { password });\n    },\n\n    async recoverFromIPFS(cid, password) {\n      return request('POST', '/recovery/ipfs/recover', { cid, password });\n    },\n  };\n}\n","/**\n * Client-side Passkey (WebAuthn) operations\n */\n\nimport type {\n  PublicKeyCredentialCreationOptionsJSON,\n  PublicKeyCredentialRequestOptionsJSON,\n  RegistrationResponseJSON,\n  AuthenticationResponseJSON,\n} from '../types/index.js';\n\n/**\n * Check if WebAuthn is supported\n */\nexport function isWebAuthnSupported(): boolean {\n  return (\n    typeof window !== 'undefined' &&\n    typeof window.PublicKeyCredential !== 'undefined' &&\n    typeof window.navigator.credentials !== 'undefined'\n  );\n}\n\n/**\n * Check if platform authenticator is available\n */\nexport async function isPlatformAuthenticatorAvailable(): Promise<boolean> {\n  if (!isWebAuthnSupported()) return false;\n  \n  try {\n    return await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Decode base64url string to ArrayBuffer\n */\nfunction base64urlToBuffer(base64url: string): ArrayBuffer {\n  const base64 = base64url.replace(/-/g, '+').replace(/_/g, '/');\n  const padLen = (4 - (base64.length % 4)) % 4;\n  const padded = base64 + '='.repeat(padLen);\n  const binary = atob(padded);\n  const bytes = new Uint8Array(binary.length);\n  for (let i = 0; i < binary.length; i++) {\n    bytes[i] = binary.charCodeAt(i);\n  }\n  return bytes.buffer;\n}\n\n/**\n * Encode ArrayBuffer to base64url string\n */\nfunction bufferToBase64url(buffer: ArrayBuffer): string {\n  const bytes = new Uint8Array(buffer);\n  let binary = '';\n  for (const byte of bytes) {\n    binary += String.fromCharCode(byte);\n  }\n  const base64 = btoa(binary);\n  return base64.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=/g, '');\n}\n\n/**\n * Create a new passkey (registration)\n */\nexport async function createPasskey(\n  options: PublicKeyCredentialCreationOptionsJSON\n): Promise<RegistrationResponseJSON> {\n  if (!isWebAuthnSupported()) {\n    throw new Error('WebAuthn is not supported in this browser');\n  }\n\n  // Convert JSON options to WebAuthn format\n  const publicKeyOptions: PublicKeyCredentialCreationOptions = {\n    challenge: base64urlToBuffer(options.challenge),\n    rp: options.rp,\n    user: {\n      id: base64urlToBuffer(options.user.id),\n      name: options.user.name,\n      displayName: options.user.displayName,\n    },\n    pubKeyCredParams: options.pubKeyCredParams,\n    timeout: options.timeout,\n    authenticatorSelection: options.authenticatorSelection,\n    attestation: options.attestation || 'none',\n    excludeCredentials: options.excludeCredentials?.map((cred) => ({\n      id: base64urlToBuffer(cred.id),\n      type: cred.type,\n      transports: cred.transports,\n    })),\n  };\n\n  // Create credential\n  const credential = await navigator.credentials.create({\n    publicKey: publicKeyOptions,\n  }) as PublicKeyCredential;\n\n  if (!credential) {\n    throw new Error('Credential creation failed');\n  }\n\n  const response = credential.response as AuthenticatorAttestationResponse;\n\n  // Convert response to JSON format\n  return {\n    id: credential.id,\n    rawId: bufferToBase64url(credential.rawId),\n    type: 'public-key',\n    response: {\n      clientDataJSON: bufferToBase64url(response.clientDataJSON),\n      attestationObject: bufferToBase64url(response.attestationObject),\n      transports: response.getTransports?.() as AuthenticationResponseJSON['response']['transports'],\n    },\n    clientExtensionResults: credential.getClientExtensionResults(),\n  };\n}\n\n/**\n * Authenticate with existing passkey\n */\nexport async function authenticateWithPasskey(\n  options: PublicKeyCredentialRequestOptionsJSON\n): Promise<AuthenticationResponseJSON> {\n  if (!isWebAuthnSupported()) {\n    throw new Error('WebAuthn is not supported in this browser');\n  }\n\n  // Convert JSON options to WebAuthn format\n  const publicKeyOptions: PublicKeyCredentialRequestOptions = {\n    challenge: base64urlToBuffer(options.challenge),\n    timeout: options.timeout,\n    rpId: options.rpId,\n    userVerification: options.userVerification,\n    allowCredentials: options.allowCredentials?.map((cred) => ({\n      id: base64urlToBuffer(cred.id),\n      type: cred.type,\n      transports: cred.transports,\n    })),\n  };\n\n  // Get credential\n  const credential = await navigator.credentials.get({\n    publicKey: publicKeyOptions,\n  }) as PublicKeyCredential;\n\n  if (!credential) {\n    throw new Error('Authentication failed');\n  }\n\n  const response = credential.response as AuthenticatorAssertionResponse;\n\n  // Convert response to JSON format\n  return {\n    id: credential.id,\n    rawId: bufferToBase64url(credential.rawId),\n    type: 'public-key',\n    response: {\n      clientDataJSON: bufferToBase64url(response.clientDataJSON),\n      authenticatorData: bufferToBase64url(response.authenticatorData),\n      signature: bufferToBase64url(response.signature),\n      userHandle: response.userHandle ? bufferToBase64url(response.userHandle) : undefined,\n    },\n    clientExtensionResults: credential.getClientExtensionResults(),\n  };\n}\n","/**\n * React Hook for Anonymous Authentication\n */\n\nimport {\n  createContext,\n  useContext,\n  useState,\n  useEffect,\n  useCallback,\n  type ReactNode,\n} from 'react';\nimport { createApiClient, type ApiClient, type SessionInfo } from '../api.js';\nimport {\n  createPasskey,\n  authenticateWithPasskey,\n  isWebAuthnSupported,\n  isPlatformAuthenticatorAvailable,\n} from '../passkey.js';\n\nexport interface AnonAuthState {\n  /** Whether initial session check is in progress */\n  isLoading: boolean;\n  /** Whether user is authenticated */\n  isAuthenticated: boolean;\n  /** User's codename (e.g., \"ALPHA-7\") */\n  codename: string | null;\n  /** User's NEAR account ID */\n  nearAccountId: string | null;\n  /** Session expiration time */\n  expiresAt: Date | null;\n  /** Whether WebAuthn is supported */\n  webAuthnSupported: boolean;\n  /** Whether platform authenticator (biometric) is available */\n  platformAuthAvailable: boolean;\n  /** Error from last operation */\n  error: string | null;\n}\n\nexport interface AnonAuthActions {\n  /** Register a new anonymous identity */\n  register(): Promise<void>;\n  /** Sign in with existing passkey */\n  login(codename?: string): Promise<void>;\n  /** Sign out */\n  logout(): Promise<void>;\n  /** Refresh session info */\n  refreshSession(): Promise<void>;\n  /** Clear error */\n  clearError(): void;\n}\n\nexport interface RecoveryActions {\n  /** Link a NEAR wallet for recovery */\n  linkWallet(signMessage: (message: string) => Promise<{ signature: string; publicKey: string }>, walletAccountId: string): Promise<void>;\n  /** Recover account using wallet */\n  recoverWithWallet(signMessage: (message: string) => Promise<{ signature: string; publicKey: string }>, nearAccountId: string): Promise<void>;\n  /** Set up IPFS password recovery */\n  setupPasswordRecovery(password: string): Promise<{ cid: string }>;\n  /** Recover using IPFS password */\n  recoverWithPassword(cid: string, password: string): Promise<void>;\n}\n\nexport type AnonAuthContextValue = AnonAuthState & AnonAuthActions & {\n  recovery: RecoveryActions;\n};\n\nconst AnonAuthContext = createContext<AnonAuthContextValue | null>(null);\n\nexport interface AnonAuthProviderProps {\n  /** API URL (e.g., '/auth') */\n  apiUrl: string;\n  /** Children */\n  children: ReactNode;\n}\n\nexport function AnonAuthProvider({ apiUrl, children }: AnonAuthProviderProps) {\n  const [api] = useState(() => createApiClient({ baseUrl: apiUrl }));\n  const [state, setState] = useState<AnonAuthState>({\n    isLoading: true,\n    isAuthenticated: false,\n    codename: null,\n    nearAccountId: null,\n    expiresAt: null,\n    webAuthnSupported: false,\n    platformAuthAvailable: false,\n    error: null,\n  });\n\n  // Check WebAuthn support on mount\n  useEffect(() => {\n    const checkSupport = async () => {\n      const webAuthnSupported = isWebAuthnSupported();\n      const platformAuthAvailable = await isPlatformAuthenticatorAvailable();\n      \n      setState((prev) => ({\n        ...prev,\n        webAuthnSupported,\n        platformAuthAvailable,\n      }));\n    };\n    \n    checkSupport();\n  }, []);\n\n  // Check session on mount\n  useEffect(() => {\n    const checkSession = async () => {\n      try {\n        const session = await api.getSession();\n        \n        setState((prev) => ({\n          ...prev,\n          isLoading: false,\n          isAuthenticated: session.authenticated,\n          codename: session.codename || null,\n          nearAccountId: session.nearAccountId || null,\n          expiresAt: session.expiresAt ? new Date(session.expiresAt) : null,\n        }));\n      } catch (error) {\n        setState((prev) => ({\n          ...prev,\n          isLoading: false,\n          error: error instanceof Error ? error.message : 'Session check failed',\n        }));\n      }\n    };\n    \n    checkSession();\n  }, [api]);\n\n  const register = useCallback(async () => {\n    try {\n      setState((prev) => ({ ...prev, isLoading: true, error: null }));\n      \n      // Start registration\n      const { challengeId, options, tempUserId, codename } = await api.startRegistration();\n      \n      // Create passkey\n      const credential = await createPasskey(options);\n      \n      // Finish registration\n      const result = await api.finishRegistration(\n        challengeId,\n        credential,\n        tempUserId,\n        codename\n      );\n      \n      if (result.success) {\n        setState((prev) => ({\n          ...prev,\n          isLoading: false,\n          isAuthenticated: true,\n          codename: result.codename,\n          nearAccountId: result.nearAccountId,\n        }));\n      } else {\n        throw new Error('Registration failed');\n      }\n    } catch (error) {\n      setState((prev) => ({\n        ...prev,\n        isLoading: false,\n        error: error instanceof Error ? error.message : 'Registration failed',\n      }));\n    }\n  }, [api]);\n\n  const login = useCallback(async (codename?: string) => {\n    try {\n      setState((prev) => ({ ...prev, isLoading: true, error: null }));\n      \n      // Start authentication\n      const { challengeId, options } = await api.startAuthentication(codename);\n      \n      // Authenticate with passkey\n      const credential = await authenticateWithPasskey(options);\n      \n      // Finish authentication\n      const result = await api.finishAuthentication(challengeId, credential);\n      \n      if (result.success) {\n        // Refresh session to get full info\n        const session = await api.getSession();\n        \n        setState((prev) => ({\n          ...prev,\n          isLoading: false,\n          isAuthenticated: true,\n          codename: session.codename || result.codename,\n          nearAccountId: session.nearAccountId || null,\n          expiresAt: session.expiresAt ? new Date(session.expiresAt) : null,\n        }));\n      } else {\n        throw new Error('Authentication failed');\n      }\n    } catch (error) {\n      setState((prev) => ({\n        ...prev,\n        isLoading: false,\n        error: error instanceof Error ? error.message : 'Login failed',\n      }));\n    }\n  }, [api]);\n\n  const logout = useCallback(async () => {\n    try {\n      await api.logout();\n      \n      setState((prev) => ({\n        ...prev,\n        isAuthenticated: false,\n        codename: null,\n        nearAccountId: null,\n        expiresAt: null,\n      }));\n    } catch (error) {\n      setState((prev) => ({\n        ...prev,\n        error: error instanceof Error ? error.message : 'Logout failed',\n      }));\n    }\n  }, [api]);\n\n  const refreshSession = useCallback(async () => {\n    try {\n      const session = await api.getSession();\n      \n      setState((prev) => ({\n        ...prev,\n        isAuthenticated: session.authenticated,\n        codename: session.codename || null,\n        nearAccountId: session.nearAccountId || null,\n        expiresAt: session.expiresAt ? new Date(session.expiresAt) : null,\n      }));\n    } catch (error) {\n      console.error('Session refresh failed:', error);\n    }\n  }, [api]);\n\n  const clearError = useCallback(() => {\n    setState((prev) => ({ ...prev, error: null }));\n  }, []);\n\n  // Recovery actions\n  const recovery: RecoveryActions = {\n    async linkWallet(signMessage, walletAccountId) {\n      const { challenge } = await api.startWalletLink();\n      const signature = await signMessage(challenge);\n      await api.finishWalletLink(signature, challenge, walletAccountId);\n    },\n\n    async recoverWithWallet(signMessage, nearAccountId) {\n      const { challenge } = await api.startWalletRecovery();\n      const signature = await signMessage(challenge);\n      const result = await api.finishWalletRecovery(signature, challenge, nearAccountId);\n      \n      if (result.success) {\n        setState((prev) => ({\n          ...prev,\n          isAuthenticated: true,\n          codename: result.codename,\n        }));\n      }\n    },\n\n    async setupPasswordRecovery(password) {\n      const result = await api.setupIPFSRecovery(password);\n      return { cid: result.cid };\n    },\n\n    async recoverWithPassword(cid, password) {\n      const result = await api.recoverFromIPFS(cid, password);\n      \n      if (result.success) {\n        setState((prev) => ({\n          ...prev,\n          isAuthenticated: true,\n          codename: result.codename,\n        }));\n      }\n    },\n  };\n\n  const value: AnonAuthContextValue = {\n    ...state,\n    register,\n    login,\n    logout,\n    refreshSession,\n    clearError,\n    recovery,\n  };\n\n  return (\n    <AnonAuthContext.Provider value={value}>\n      {children}\n    </AnonAuthContext.Provider>\n  );\n}\n\n/**\n * Hook to access anonymous auth state and actions\n */\nexport function useAnonAuth(): AnonAuthContextValue {\n  const context = useContext(AnonAuthContext);\n  \n  if (!context) {\n    throw new Error('useAnonAuth must be used within AnonAuthProvider');\n  }\n  \n  return context;\n}\n"]}